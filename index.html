<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ECNA Gestion Visa - Extension Trimble Connect</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0; /* Réinitialise la marge par défaut du body */
        background-color: #f0f0f0;
        color: #333;
        text-align: center;
        display: flex; /* Utilise flexbox pour la mise en page principale */
        flex-direction: column; /* Organise les éléments en colonne */
        height: 100vh; /* Prend toute la hauteur de la vue */
      }
      /* Style du bandeau horizontal */
      .header-banner {
        background-color: #0056b3; /* Bleu Eiffage */
        padding: 10px 20px;
        display: flex; /* Utilise flexbox pour organiser les boutons */
        justify-content: flex-start; /* Aligne les boutons au début (à gauche) */
        align-items: center; /* Centre verticalement les boutons */
        gap: 15px; /* Espace entre les boutons */
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Légère ombre pour donner du relief */
      }
      /* Style des boutons dans le bandeau */
      .header-banner button {
        background-color: #ffffff; /* Fond blanc pour les boutons */
        color: #0056b3; /* Texte bleu Eiffage */
        border: none;
        padding: 10px 15px;
        border-radius: 5px; /* Bords légèrement arrondis */
        cursor: pointer;
        font-size: 1rem;
        transition:
          background-color 0.3s ease,
          color 0.3s ease; /* Transition douce pour l'effet hover */
      }
      .header-banner button:hover {
        background-color: #e0e0e0; /* Changement de couleur au survol */
        color: #003a72; /* Couleur de texte plus foncée au survol */
      }
      /* Style pour le contenu principal */
      .main-content {
        flex-grow: 1; /* Prend l'espace restant */
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.2rem;
        color: #666;
      }

      h1 {
        color: #0056b3; /* Bleu Eiffage (exemple) */
      }
      p {
        margin-top: 15px;
      }
    </style>
  </head>
  <body>
    <!-- Bandeau horizontal avec les boutons -->
    <div class="header-banner">
      <button id="dashboardBtn">Tableau de Bord</button>
      <button id="visasBtn">Visas</button>
      <button id="configBtn">Configuration</button>
    </div>

    <!-- Contenu principal de l'extension -->
    <div class="main-content">
      <p>
        Bienvenue sur l'interface de gestion de visa ECNA ! Cliquez sur un
        bouton ci-dessus pour commencer.
      </p>
    </div>

    <!-- Script pour l'intégration Trimble Connect -->
    <script src="https://components.connect.trimble.com/trimble-connect-workspace-api/index.js"></script>
    <script>
      (async function () {
        try {
          // Établir la connexion avec l'API de Trimble Connect
          const API = await TrimbleConnectWorkspace.connect(
            window.parent,
            (event, data) => {
              console.log("Événement Trimble Connect reçu : ", event, data);
              // Ici, tu peux gérer les événements reçus de Trimble Connect, par exemple quand on clique sur un sous-menu
              if (
                event === "extension.command" &&
                data === "ecna_gestion_visa_clicked"
              ) {
                console.log("Le menu ECNA Gestion Visa a été cliqué !");
                // Tu peux mettre à jour ton interface ici si nécessaire
              }
            },
            30000, // Délai de connexion en millisecondes
          );

          // Définir la structure du menu principal pour ton extension
          const mainMenuObject = {
            title: "ECNA Gestion Visa", // Le texte qui apparaîtra dans l'arborescence
            icon: "https://dorianlorenzato-max.github.io/trimble-connect-ecna-extension/logoEiffage.png", // L'icône de l'extension
            command: "ecna_gestion_visa_clicked", // Une commande unique associée à ce menu
          };

          // Envoyer l'objet menu à Trimble Connect pour l'afficher
          API.ui.setMenu(mainMenuObject);
          console.log("Menu 'ECNA Gestion Visa' envoyé à Trimble Connect.");

          // Optionnel : Obtenir des informations sur le projet ou l'utilisateur
          const projectInfo = await API.project.getCurrentProject();
          console.log("Projet actuel :", projectInfo.name);
        } catch (error) {
          console.error(
            "Erreur lors de la connexion à l'API Trimble Connect ou de la configuration du menu :",
            error,
          );
        }
      })();
    </script>
  </body>
</html>
